<h1>Friends</h1>
<div class="row">
	<div class="col-md-2">
	</div>
	<div class="col-md-8">
		<div class="col-md-10">
      <%= form_tag friends_path, :method => 'get' do %>
        <p>
          <%= text_field_tag :search, params[:search] %>
          <%= submit_tag "Search", :name => nil %>
        </p>
      <% end %>

	  </div>
    <% if @find_friends.any? %>
      <table class="table">
        <tbody>
          <% @find_friends.each do |f| %>
            <% if f.id != current_user.id %>
            <tr>
              <td><%= f.username %></td>
              <td><%= f.first_name + " " + f.last_name %></td>
              <td><%= link_to 'Show', f %></td>
              <% @friend_id = f.id %>
              <% check_friend(current_user.id, f.id) %>
              <% if @check_friend == nil %>
              <td>
              <%= simple_form_for @friend, html: {:class => 'form-horizontal' }, method: :post do |f| %>
              <%= tag(:input, :type => "hidden", :name => request_forgery_protection_token.to_s, :value => form_authenticity_token) %>
              <%= f.hidden_field :user_id, value: @friend_id %>
              <%= f.hidden_field :request, value: "pending" %>
              <%= f.hidden_field :friend_id, value: current_user.id %>
                <div class='form-group'>
                  <%= f.submit 'Send friend request' , :class => "btn btn-primary" %>
                </div>
              <% end %></td>
              <% else %>
              <td><%= @check_friend.request %></td>
              <% end %>

            </tr>
            <% end %>
            <% end %>
        </tbody>
      </table>
    <% end %>
    <table class="table">
        <tbody>
          <% @friends.each do |friend| %>
            <tr>
              <td><%= friend.user.username %></td>
              <% if friend.request == "pending" %>
              <td>Friend request pending</td>
              <% elsif friend.request == "sent" %>
              <td>Friendship requested</td>
              <% end %>
              <td><%= link_to 'Show', friend.user %></td>

            </tr>
          <% end %>
        </tbody>
      </table>
	</div>
	<div class="col-md-2"></div>
</div>